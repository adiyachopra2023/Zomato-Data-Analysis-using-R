## Analysis and Inferences

***
```{r}
#packages
library(dplyr)
library(ggplot2)
#packageVersion('rlang')
#remove.packages('rlang')
#install.packages('rlang')
```

***
Reading Excel File into a variable.

```{r}
#Changing Directory to Current Working Directory
#Reading CSV file into a variable
zomato <- read.csv('D:/VIT/CSE3505/zomato.csv.xls')
#zomato
```


***
Cleaning dataset

```{r}
sum(is.na(zomato))

#Inference: The data set is clean. It does not have any NA values.
```

***
Describing the dataset.

```{r}
View(zomato)
str(zomato)
dim(zomato)
head(zomato)
tail(zomato)
```

***
Summarizing the dataset.
```{r}
summary(zomato)

#Inferences
#The mean of average cost for two is 1199.
#Mean price range is 1.805

```

***
The most used Currency.
```{r}
#zomato$City
#Substituting special characters with empty string
zomato$Currency <- gsub("[^[:alnum:]]", "", zomato$Currency, perl=TRUE)
zomato$Currency <- gsub("[^a-zA-Z0-9]", "", zomato$Currency, perl=TRUE)
ggplot(zomato, aes(x=zomato$Currency, fill=zomato$Currency))+geom_bar()

#Inference:
#IndianRupees(Rs) is the most used currency among Zomato's customers
```

***
The city to in which Zomato delivers the most

```{r}
#Substituting special characters with empty string
zomato$City <- gsub("[^[:alnum:]]", "", zomato$City, perl=TRUE)
zomato$City <- gsub("[^a-zA-Z0-9]", "", zomato$City, perl=TRUE)
ggplot(zomato, aes(x=zomato$City, fill=zomato$City))+geom_bar()

freq1 <- table(zomato$City)
freq1
barplot(freq1, xlab="City", ylab="Frequency")
freq1[which.max(freq1)]
freq1[which.min(freq1)]
#Inference:
#The maximum Zomato deliveries are made to New Delhi
#The minimum Zomato deliveries aee made to Armidale
boxplot(freq1)
```

***
Plotting the longitude and latitude to visualize the various restaurants' locations collected in the dataset.  
```{r}
#library(ggmap)
ggplot(zomato, aes(x=Longitude, y=Latitude))+geom_point()
#install.packages("mapview")
#install.packages("tidyverse")
#install.packages("sf")
#install.packages("terra")
#install.packages("remotes")
library(tidyverse)
library(sf)
library(mapview)
library(terra)
library(remotes)
#remotes::install_github("r-spatial/mapview")
mapview(zomato, xcol="Longitude", ycol="Latitude", crs = 4269, grid=FALSE)
```

***
How many restaurants have table booking for dine-in.

```{r}
freq2 <- table(zomato$Has.Table.booking)
pie(freq2, radius=1, col=c("pink", "cyan"))

#Inference - Majority restaurants in this dataset don't have table bookings which increases the sales of Zomato
```


***
How many restaurants have their own online delivery service

```{r}
freq6 <- table(zomato$Has.Online.delivery)
pie(freq6 ,radius=1, col=c("cyan", "pink"))

#Inference - Majority restaurants in this dataset don't have their own online delivery services which increases the customer base of Zomato
```

***
What is the maximum and minimum average cost for two in the restaurants and the respective cities.

```{r}
maxCost <- which.max(zomato$Average.Cost.for.two)
maxCost
zomato$City[maxCost]
#Inference
#Jakarta has the maximum average cost for two i.e., Jakarta has the most expensive restaurants which offer Zomato delivery services.

minCost <- which.min(zomato$Average.Cost.for.two)
minCost
zomato$City[minCost]
#Inference
#Albany has the minimum average cost for two i.e., Albany has the least expensive restaurants which offer Zomato delivery services.
```

***
The price range pie chart

```{r}
freq3 <- table(zomato$Price.range)
freq3
pie(freq3, radius = 1)
#Inference:
#The most common price range is 1.
```

***
Rating Text

```{r}
freq5 <- table(zomato$Rating.text)
ggplot(zomato, aes(x=Rating.text, fill=City))+geom_bar()
barplot(freq5, xlab="Rating Text", ylab="Frequency")
```

***
Aggregate rating Plot

```{r}
hist(zomato$Aggregate.rating)
```

***
Votes

```{r}
freq9 <- unique(zomato$Votes)
hist(freq9)
plot(zomato$Votes)
```


***
Cities with average rating of services.

```{r}
restavg <- zomato %>%
  filter(Rating.text=="Average")
restavg
freq7 <- unique(restavg)
freq7
unique(restavg$City)
#Inference:
#The following cities have average rated services by Zomato
```

***
Rating vs Price Range

```{r}
ggplot(zomato, aes(x=Rating.text, fill=Price.range))+geom_bar() +ggtitle("Quality Analysis")

#Inference:
#The most common rating for Zomato services is average and the least common is poorly rated.
```

***
Which is the most commonly ordered Cuisine?

```{r}
gsub(" ", "", zomato$Cuisines, perl=TRUE)
#Seperating multiple comma separated cuisines in each record
cuisines <- unlist(strsplit(zomato$Cuisines,","))
cuisines <- gsub(" ", "", cuisines, perl=TRUE)
unique(cuisines)
freq9 <- table(cuisines)
freq9
freq9[which.max(freq9)]
#Inference:
#The most common cuisine is North Indian
#The biggest customer base of Zomato services is in India.
```


## References
Dataset - https://drive.google.com/file/d/1FSa_x3COvCoMODa44qXufO9CQb3ydqKw/view

1.https://www.ijraset.com/research-paper/paper-on-zomato-data-analysis
2.https://www.researchgate.net/publication/355398297_Sentiment_Analysis_of_Zomato_and_Swiggy_Food_Delivery_Management_System 
